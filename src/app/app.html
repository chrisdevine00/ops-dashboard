<mat-toolbar color="primary" class="toolbar">
  <button mat-icon-button class="home-button" title="Home">
    <mat-icon>home</mat-icon>
  </button>
  <span class="title">{{ facilityName }} | {{ serialNumber }}</span>
  <span class="spacer"></span>
  <div class="time-display">
    <div class="time-row">
      <span class="time-label">Site Time:</span>
      <span class="time-value">{{ siteTime }}</span>
    </div>
    <div class="time-row">
      <span class="time-label">Local Time:</span>
      <span class="time-value">{{ localTime }}</span>
    </div>
  </div>
  <div class="refresh-section">
    <span class="refresh-info">{{ refreshText }}</span>
    <button mat-icon-button (click)="refreshNow()" [title]="'Refresh now'">
      <mat-icon>refresh</mat-icon>
    </button>
  </div>
</mat-toolbar>

<div class="container">
  <!-- Date Navigation -->
  <div class="date-navigation">
    <button mat-icon-button (click)="prevDay()" class="nav-button">
      <mat-icon>chevron_left</mat-icon>
    </button>
    <div class="date-picker-wrapper">
      <div class="current-date" (click)="picker.open()">
        {{ formattedDate }}
        <mat-icon class="calendar-icon">calendar_today</mat-icon>
      </div>
      <input
        matInput
        [matDatepicker]="picker"
        [value]="currentDate"
        [max]="today"
        (dateChange)="onDateChange($event)"
        class="hidden-date-input"
      >
      <mat-datepicker #picker></mat-datepicker>
    </div>
    <button mat-icon-button (click)="nextDay()" class="nav-button" [disabled]="isToday">
      <mat-icon>chevron_right</mat-icon>
    </button>
    <button mat-stroked-button (click)="goToToday()" class="today-button" [disabled]="isToday">
      Today
    </button>
  </div>

  <!-- Gantt Charts -->
  <mat-card class="chart-card">
    <mat-card-content>
      <div echarts [options]="leftGxChartOptions" class="gantt-chart"></div>
    </mat-card-content>
  </mat-card>

  <mat-card class="chart-card">
    <mat-card-content>
      <div echarts [options]="rightMxChartOptions" class="gantt-chart"></div>
    </mat-card-content>
  </mat-card>

  <mat-card class="chart-card">
    <mat-card-content>
      <div echarts [options]="pxChartOptions" class="state-chart"></div>
    </mat-card-content>
  </mat-card>

  <!-- Workflow Metrics -->
  <div class="metrics-grid">
    <mat-card class="metric-card">
      <mat-card-header>
        <mat-card-title>Active Workflows</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="metric-value">{{ activeWorkflows }}</div>
        <div class="metric-unit">running</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-header>
        <mat-card-title>Completed Today</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="metric-value">{{ completedToday }}</div>
        <div class="metric-unit">workflows</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-header>
        <mat-card-title>Avg Workflow Time</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="metric-value">{{ avgWorkflowTime }}</div>
        <div class="metric-unit">minutes</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-header>
        <mat-card-title>Alerts Generated</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="metric-value">{{ alertsGenerated }}</div>
        <div class="metric-unit">today</div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
